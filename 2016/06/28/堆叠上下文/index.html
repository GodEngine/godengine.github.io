<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>堆叠上下文 | 发动机的博客</title>
  <meta name="author" content="John Doe">
  
  <meta name="description" content="什么是stacking contexts 堆叠上下文">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="堆叠上下文"/>
  <meta property="og:site_name" content="发动机的博客"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="发动机的博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">发动机的博客</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-06-28T05:43:52.000Z"><a href="/2016/06/28/堆叠上下文/">2016-06-28</a></time>
      
      
  
    <h1 class="title">堆叠上下文</h1>
  

    </header>
    <div class="entry">
      
        <h2 id="什么是stacking-contexts-堆叠上下文"><a href="#什么是stacking-contexts-堆叠上下文" class="headerlink" title="什么是stacking contexts 堆叠上下文"></a>什么是stacking contexts 堆叠上下文</h2><a id="more"></a>
<p>堆叠上下文是css里一个概念，某些元素可以产生一个堆叠上下文，来包含这个元素的子元素的层级关系。堆叠上下文有两种，一种为<strong>根堆叠上下文</strong>(<em>root stacking context</em>),一种为<strong>局部堆叠上下文</strong>(<em>local stacking context</em>)</p>
<ul>
<li><strong>root stacking context</strong><br>根堆叠上下文，即HTML根元素默认产生一个<em>stacking context</em>，是html元素，而不是body元素。</li>
<li><strong>local stacking context</strong><br>菊部堆叠上下文，除了HTML元素，符合以下条件的元素也可生成<em>local stacking context</em>，常见的如下：</li>
</ul>
<ol>
<li>positioned(absolute和relative)元素且该元素带有非auto值的z-index属性</li>
<li>含opacity属性且不为1的元素</li>
<li>含transform属性且不为auto值的元素</li>
<li>含filter属性且不为none值得元素</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context#The_stacking_context" target="_blank" rel="external">不常见的</a></li>
</ol>
<h2 id="堆叠上下文有什么用"><a href="#堆叠上下文有什么用" class="headerlink" title="堆叠上下文有什么用"></a>堆叠上下文有什么用</h2><p>我们在比较不同层的高低是基于堆叠上下文来比较的。</p>
<ul>
<li>一种情况是某一个元素产生了堆叠上下文，我们就说它的子元素处在同一个堆叠上下文中，我们对这些子元素(即兄弟元素)的层次进行比较</li>
<li>另一种情况是我们要比较的元素不在同一个堆叠上下文中，即他们不在同一个产生堆叠上下文的父元素下(即非兄弟元素)</li>
<li>再来一种，即子元素和父元素的层次比较</li>
</ul>
<p>第一种情况下层次的堆叠规则如下(从低到高)：</p>
<ol>
<li>堆叠级别为负值的positioned元素，典型的如z-index=-1</li>
<li>非positioned元素</li>
<li>positioned且z-index为auto的元素</li>
<li>positioned且z-index为正值的元素，典型的如z-index=1</li>
</ol>
<p>第二种情况：<br>1，当比较的两元素处在不同的堆叠上下文时，父元素层次较高(A)的所有子元素(aa)，层次上都高于父元素层次低(B)的所有子元素(bb)，即子元素不处于同一个堆叠上下文的要依据他们父元素的层次。所以z-index大的元素不一定比z-index小的元素层次高，还要看他们是否处于同一个堆叠上下文中，否时谁所处的堆叠层次高</p>
<p>第三种情况：</p>
<ol>
<li>产生堆叠上下文元素的所有子元素都在父元素的上面，无论子元素层次有多低</li>
<li>当父元素没有产生堆叠上下文时，子元素如果为positioned元素且z-index为负值，就遵循第一情况中所说的，在父元素下面了</li>
<li>根元素的背景和border处于最低层次中。</li>
</ol>
<h2 id="含z-index属性定位元素的堆叠规则"><a href="#含z-index属性定位元素的堆叠规则" class="headerlink" title="含z-index属性定位元素的堆叠规则"></a>含z-index属性定位元素的堆叠规则</h2><p>以一张图作为开始：<br><img src="/images/z-index.png" alt="z-index的堆叠规则"></p>
<ul>
<li>positioned且设置z-index的元素产生一个堆叠上下文，其子元素将处于父元素创建的这个局部堆叠上下文中。</li>
<li>div1,2,3互为兄弟元素，且都设置了position与z-index，故同处在根元素下(根元素默认产生堆叠上下文)产生的<strong>这个</strong>堆叠上下文中。同理div4,5,6这几个兄弟元素也处在共同的父元素div3的<strong>这个</strong>堆叠上下文中。两个”这个”是说明这两个堆叠上下文是独立的，是不同的堆叠上下文。</li>
<li>同一个堆叠上下文中，z-index越大，在三维空间上的z轴值越大，层次上表现为在上层。所以div1,2,3在父元素根元素的堆叠上下文中按z-index值大小确定层次关系，div4,5,6在父元素div3的堆叠上下文中按z-index值大小确定层次关系。</li>
<li>不在同一个堆叠上下文，即不属于兄弟关系的元素在比较层次关系时，堆叠规则取决于父元素，div1,2,3处于同一个堆叠上下文中，div3在其同辈元素中高于div2，低于div1。所以div3的子元素div4,5,6与div1,2比较时和父元素保持一致，也都高于div2，低于div1。</li>
<li>子元素与父元素不在同一个堆叠上下文中且层次高于父元素，所以看到div4,5,6都在div3之上。</li>
<li>以上所有元素(除了根元素)都设置了positioned和z-index。</li>
</ul>
<h2 id="无z-index属性情况下默认的堆叠规则"><a href="#无z-index属性情况下默认的堆叠规则" class="headerlink" title="无z-index属性情况下默认的堆叠规则"></a>无z-index属性情况下默认的堆叠规则</h2><p>从下往上的层次关系一次为：</p>
<ol>
<li>根元素的背景和border</li>
<li>普通流中的后代元素，按在html出现的先后顺序</li>
<li>定位的后代元素或浮动元素，按在html中出现的先后顺序</li>
</ol>
<h2 id="理论完毕，以下为带图的各种资源，对比理论更容易理解"><a href="#理论完毕，以下为带图的各种资源，对比理论更容易理解" class="headerlink" title="理论完毕，以下为带图的各种资源，对比理论更容易理解"></a>理论完毕，以下为带图的各种资源，对比理论更容易理解</h2><ol>
<li><a href="http://webcache.googleusercontent.com/search?q=cache:ENtnR_I7TpgJ:www.neoease.com/css-z-index-property-and-layering-tree/+&amp;cd=5&amp;hl=zh-CN&amp;ct=clnk" target="_blank" rel="external">层级树</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/Stacking_without_z-index" target="_blank" rel="external">无z-index情况下的堆叠规则</a> </li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/Stacking_and_float" target="_blank" rel="external">浮动情况的堆叠规则</a>,规则貌似和例子实际情况不太一样</li>
<li><a href="http://www.neoease.com/tutorials/z-index/" target="_blank" rel="external">示例</a></li>
</ol>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/css/">css</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/干货/">干货</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Kommentare</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://yoursite.com/2016/06/28/堆叠上下文/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Suche">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Kategorien</h3>
  <ul class="entry">
  
    <li><a href="/categories/css/">css</a><small>11</small></li>
  
    <li><a href="/categories/js/">javascript</a><small>8</small></li>
  
    <li><a href="/categories/life/">life</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/css3/">css3</a><small>8</small></li>
  
    <li><a href="/tags/es6/">es6</a><small>1</small></li>
  
    <li><a href="/tags/干货/">干货</a><small>3</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 John Doe
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
